# dotfiles settings
DOTFILES_REPOSITORY="git@github.com:fabiano/dotfiles.git"
DOTFILES_INSTALL_DIR="$HOME/.dotfiles"

# zsh-syntax-highlighting
if [ -f "/usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ] ; then
  source /usr/local/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
fi

if [ -f "/usr/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh" ] ; then
  source /usr/share/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh
fi

# zsh-autosuggestions
if [ -f "/usr/local/share/zsh-autosuggestions/zsh-autosuggestions.zsh" ] ; then
  source /usr/local/share/zsh-autosuggestions/zsh-autosuggestions.zsh
fi

if [ -f "/usr/share/zsh-autosuggestions/zsh-autosuggestions.zsh" ] ; then
  source /usr/share/zsh-autosuggestions/zsh-autosuggestions.zsh
fi

# alias
alias ..="cd .."
alias ~="cd ~"

if [ -f "/usr/bin/exa" ] ; then
  alias ls="exa"
fi

if [ -f "/usr/bin/bat" ] ; then
  alias cat="bat"
fi

if [ -f "/usr/bin/batcat" ] ; then
  alias cat="batcat"
fi

alias g="git"
alias v="vim"

# keys
bindkey "^[[1;5C" forward-word  # ctrl + right arrow
bindkey "^[[1;5D" backward-word # ctrl + left arrow

# configure wls ssh forwarding
if [[ $(grep -i Microsoft /proc/version) ]]; then
  export SSH_AUTH_SOCK=$HOME/.ssh/agent.sock

  ALREADY_RUNNING=$(ps -auxww | grep -q "[n]piperelay.exe -ei -s //./pipe/openssh-ssh-agent"; echo $?)

  if [[ $ALREADY_RUNNING != "0" ]]; then
      if [[ -S $SSH_AUTH_SOCK ]]; then
          rm $SSH_AUTH_SOCK
      fi

      (setsid socat UNIX-LISTEN:$SSH_AUTH_SOCK,fork EXEC:"npiperelay.exe -ei -s //./pipe/openssh-ssh-agent",nofork &) >/dev/null 2>&1
  fi
fi

# start starship
eval "$(starship init zsh)"
